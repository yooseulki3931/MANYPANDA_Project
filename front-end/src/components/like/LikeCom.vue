<template>
  <div class="col-10">
    <div class="sold_back">
      <h4 id="sold_sale_logo">ğŸ¤ My like list ğŸ¤</h4>

      <!-- ììœ ê²Œì‹œíŒ -->
      <div class="col-5" id="wrote_fb">
        <p id="wrote_title">ììœ  ê²Œì‹œíŒ</p>
        <table class="table table-borderless" id="wrote_table">
          <thead>
            <tr id="cart_tr">
              <th scope="col" colspan="3">ì œëª©</th>
              <th scope="col">ì‘ì„±ì</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody v-for="(data, index) in goods" :key="index" id="sold_tbody">
            <tr id="cart_tr">
              <td colspan="3" id="cart_td">
                <router-link :to="'/fb/' + data.fno">
                  {{ data.fbTitle }}
                </router-link>
              </td>
              <td id="cart_td">{{ data.nick }}</td>
              <button style="border: none; width: 16px;" @click="deleteLikeFb(goods[index].fno)" id="cart_delete">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg"
                  viewBox="0 0 16 16">
                  <path
                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>
              </button>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ì¶”ì²œê²Œì‹œíŒ -->
      <div class="col-5" id="wrote_fb">
        <p id="wrote_title">ì¶”ì²œ ê²Œì‹œíŒ</p>
        <table class="table table-borderless" id="wrote_table">
          <thead>
            <tr id="cart_tr">
              <th scope="col" colspan="3">ì œëª©</th>
              <th scope="col">ì‘ì„±ì</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody v-for="(data, index) in bb" :key="index" id="sold_tbody">
            <tr id="cart_tr">
              <td colspan="3" id="cart_td">
                <router-link :to="'/bb/' + data.bno">
                  {{ data.bbTitle }}
                </router-link>
              </td>
              <td id="cart_td">{{ data.nick }}</td>
              <button style="border: none; width: 16px;" @click="deleteLikeBb(bb[index].bno)" id="cart_delete">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg"
                  viewBox="0 0 16 16">
                  <path
                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>
              </button>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ëª¨ì„ê²Œì‹œíŒ -->
      <div class="col-5" id="wrote_fb">
        <p id="wrote_title">ëª¨ì„ ê²Œì‹œíŒ</p>
        <table class="table table-borderless" id="wrote_table">
          <thead>
            <tr id="cart_tr">
              <th scope="col" colspan="3">ì œëª©</th>
              <th scope="col">ì‘ì„±ì</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody v-for="(data, index) in mb" :key="index" id="sold_tbody">
            <tr id="cart_tr">
              <td colspan="3" id="cart_td">
                <router-link :to="'/mb/' + data.mno">
                  {{ data.mbTitle }}
                </router-link>
              </td>
              <td id="cart_td">{{ data.nick }}</td>
              <button style="border: none; width: 16px;" @click="deleteLikeMb(mb[index].mno)" id="cart_delete">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg"
                  viewBox="0 0 16 16">
                  <path
                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>
              </button>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ë¶„ì‹¤ê²Œì‹œíŒ -->
      <div class="col-5" id="wrote_fb">
        <p id="wrote_title">ë¶„ì‹¤/ì‹ ê³  ê²Œì‹œíŒ</p>
        <table class="table table-borderless" id="wrote_table">
          <thead>
            <tr id="cart_tr">
              <th scope="col" colspan="3">ì œëª©</th>
              <th scope="col">ì‘ì„±ì</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody v-for="(data, index) in lb" :key="index" id="sold_tbody">
            <tr id="cart_tr">
              <td colspan="3" id="cart_td">
                <router-link :to="'/lb/' + data.lno">
                  {{ data.lbTitle }}
                </router-link>
              </td>
              <td id="cart_td">{{ data.nick }}</td>
              <button style="border: none; width: 16px;" @click="deleteLikeLb(lb[index].lno)" id="cart_delete">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg"
                  viewBox="0 0 16 16">
                  <path
                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>
              </button>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>

<script>
/* eslint-disable */
import UserDataService from "../../services/UserDataService";
import FbService from "../../services/FbService";
import BbService from "../../services/BbService";
import MbService from "../../services/MbService";
import LbService from "../../services/LbService";
import FbLikeService from "@/services/FbLikeService";
import MbLikeService from "@/services/MbLikeService";
import LbLikeService from "@/services/LbLikeService";
import BbLikeService from "@/services/BbLikeService";

export default {
  props: ["likeProps"],
  data() {
    return {
      goods: [],
      mb: [],
      bb: [],
      lb: [],
      currentUser: null,
      id: this.likeProps,
      deletefbid: null,
      deletelbid: null,
      deletembid: null,
      deletebbid: null,

    };
  },
  methods: {
    deleteLikeFb(num) {
      FbLikeService.getLike(num, this.$store.state.auth.user.id)
        .then((response) => {
          this.deletefbid = response.data.fbLikeId;
          FbLikeService.delete(this.deletefbid)
            .then((response) => {
              console.log(response.data);
              alert("ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
              location.href = `/myPage`
            })
            .catch((e) => {
              console.log(e);
            })

        })
        .catch((e) => {
          console.log(e);
        });

      this.getLike();
      this.retrieveFb();
      this.retrieveMb();
      this.retrieveBb();
      this.retrieveLb();
    },
    deleteLikeMb(num) {
      MbLikeService.getLike(num, this.$store.state.auth.user.id)
        .then((response) => {
          this.deletembid = response.data.mbLikeId;
          MbLikeService.delete(this.deletembid)
            .then((response) => {
              console.log(response.data);
              alert("ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
              location.href = `/myPage`
            })
            .catch((e) => {
              console.log(e);
            })

        })
        .catch((e) => {
          console.log(e);
        });

      this.getLike();
      this.retrieveFb();
      this.retrieveMb();
      this.retrieveBb();
      this.retrieveLb();
    },
    deleteLikeLb(num) {
      LbLikeService.getLike(num, this.$store.state.auth.user.id)
        .then((response) => {
          this.deletelbid = response.data.lbLikeId;
          LbLikeService.delete(this.deletelbid)
            .then((response) => {
              console.log(response.data);
              alert("ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
              location.href = `/myPage`
            })
            .catch((e) => {
              console.log(e);
            })

        })
        .catch((e) => {
          console.log(e);
        });

      this.getLike();
      this.retrieveFb();
      this.retrieveMb();
      this.retrieveBb();
      this.retrieveLb();
    },
    deleteLikeBb(num) {
      BbLikeService.getLike(num, this.$store.state.auth.user.id)
        .then((response) => {
          this.deletebbid = response.data.bbLikeId;
          BbLikeService.delete(this.deletebbid)
            .then((response) => {
              console.log(response.data);
              alert("ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
              location.href = `/myPage`
            })
            .catch((e) => {
              console.log(e);
            })

        })
        .catch((e) => {
          console.log(e);
        });

      this.getLike();
      this.retrieveFb();
      this.retrieveMb();
      this.retrieveBb();
      this.retrieveLb();
    },

    getLike() {
      UserDataService.getGoodFbList(this.id) // spring ìš”ì²­
        //  ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë¥´ê² ì§€ë§Œ/l
        //  ì„±ê³µí•˜ë©´ thenì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .then((response) => {
          console.log("fbì„±ê³µ");
          this.goods = response.data;
          console.log(response.data);
        })
        //  ì‹¤íŒ¨í•˜ë©´ catchì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .catch((e) => {
          console.log("fbì‹¤íŒ¨");
          console.log(e);
        });
      UserDataService.getGoodLbList(this.id) // spring ìš”ì²­
        //  ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë¥´ê² ì§€ë§Œ/l
        //  ì„±ê³µí•˜ë©´ thenì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .then((response1) => {
          this.lb = response1.data;
          console.log(response1.data);
        })
        //  ì‹¤íŒ¨í•˜ë©´ catchì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .catch((e) => {
          console.log(e);
        });
      UserDataService.getGoodMbList(this.id) // spring ìš”ì²­
        //  ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë¥´ê² ì§€ë§Œ/l
        //  ì„±ê³µí•˜ë©´ thenì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .then((response2) => {
          this.mb = response2.data;
          console.log(response2.data);
        })
        //  ì‹¤íŒ¨í•˜ë©´ catchì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .catch((e) => {
          console.log(e);
        });
      UserDataService.getGoodBbList(this.id) // spring ìš”ì²­
        //  ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë¥´ê² ì§€ë§Œ/l
        //  ì„±ê³µí•˜ë©´ thenì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .then((response3) => {
          this.bb = response3.data;
          console.log(response3.data);
        })
        //  ì‹¤íŒ¨í•˜ë©´ catchì•ˆì— ìˆëŠ”ê²ƒì´ ì‹¤í–‰
        .catch((e) => {
          console.log(e);
        });
    },

    // ì¡°íšŒ
    retrieveFb() {
      FbService.getAll(
        // this.fb_ctitle, // select box ì„ íƒëœ ê°’
        // this.fb_title, // ì œëª© ê²€ìƒ‰
        this.page - 1,
        this.pageSize
      )
        // ì„±ê³µí•˜ë©´ .then() ê²°ê³¼ê°€ ì „ì†¡ë¨
        .then((response) => {
          console.log("fb ì¢‹ì•„ìš” ì„±ê³µ");
          const { goods, totalItems } = response.data; // springboot ì˜ ì „ì†¡ëœ ë§µ ì •ë³´
          this.goods = goods; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ ë°ì´í„°
          this.count = totalItems; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ í˜ì´ì§€ì •ë³´(ì´ ê±´ìˆ˜)

          // ë””ë²„ê¹… ì½˜ì†”ì— ì •ë³´ ì¶œë ¥
          console.log(response.data);
        })
        // ì‹¤íŒ¨í•˜ë©´ .catch() ì— ì—ëŸ¬ê°€ ì „ì†¡ë¨
        .catch((e) => {
          console.log(e);
        });
    },
    retrieveBb() {
      BbService.getAll(
        this.page - 1,
        this.pageSize
      )
        // ì„±ê³µí•˜ë©´ .then() ê²°ê³¼ê°€ ì „ì†¡ë¨
        .then((response) => {
          console.log("bb ì¢‹ì•„ìš” ì„±ê³µ");
          const { bb, totalItems } = response.data; // springboot ì˜ ì „ì†¡ëœ ë§µ ì •ë³´
          this.bb = bb; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ ë°ì´í„°
          this.count = totalItems; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ í˜ì´ì§€ì •ë³´(ì´ ê±´ìˆ˜)

          // ë””ë²„ê¹… ì½˜ì†”ì— ì •ë³´ ì¶œë ¥
          console.log(response.data);
        })
        // ì‹¤íŒ¨í•˜ë©´ .catch() ì— ì—ëŸ¬ê°€ ì „ì†¡ë¨
        .catch((e) => {
          console.log(e);
        });
    },
    retrieveMb() {
      MbService.getAll(
        this.page - 1,
        this.pageSize
      )
        // ì„±ê³µí•˜ë©´ .then() ê²°ê³¼ê°€ ì „ì†¡ë¨
        .then((response) => {
          console.log("mb ì¢‹ì•„ìš” ì„±ê³µ");
          const { mb, totalItems } = response.data; // springboot ì˜ ì „ì†¡ëœ ë§µ ì •ë³´
          this.mb = mb; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ ë°ì´í„°
          this.count = totalItems; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ í˜ì´ì§€ì •ë³´(ì´ ê±´ìˆ˜)

          // ë””ë²„ê¹… ì½˜ì†”ì— ì •ë³´ ì¶œë ¥
          console.log(response.data);
        })
        // ì‹¤íŒ¨í•˜ë©´ .catch() ì— ì—ëŸ¬ê°€ ì „ì†¡ë¨
        .catch((e) => {
          console.log(e);
        });
    },
    retrieveLb() {
      LbService.getAll(
        this.page - 1,
        this.pageSize
      )
        // ì„±ê³µí•˜ë©´ .then() ê²°ê³¼ê°€ ì „ì†¡ë¨
        .then((response) => {
          console.log("lb ì¢‹ì•„ìš” ì„±ê³µ");
          const { lb, totalItems } = response.data; // springboot ì˜ ì „ì†¡ëœ ë§µ ì •ë³´
          this.lb = lb; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ ë°ì´í„°
          this.count = totalItems; // ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ì „ì†¡í•œ í˜ì´ì§€ì •ë³´(ì´ ê±´ìˆ˜)

          // ë””ë²„ê¹… ì½˜ì†”ì— ì •ë³´ ì¶œë ¥
          console.log(response.data);
        })
        // ì‹¤íŒ¨í•˜ë©´ .catch() ì— ì—ëŸ¬ê°€ ì „ì†¡ë¨
        .catch((e) => {
          console.log(e);
        });
    },
  },

  mounted() {
    this.getLike();
  },
};
</script>

<style>
@import url(@/assets/css/style.css);
</style>